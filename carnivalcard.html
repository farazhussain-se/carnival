<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Digital Crew Card - Carnival</title>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        carnivalRed: '#E31837',
                        carnivalBlue: '#0033A0',
                        carnivalDark: '#00205B'
                    }
                }
            }
        }
    </script>

    <style>
        /* --- SCROLL FIX: No height definitions anywhere --- */
        * { box-sizing: border-box; }
        html {
            overflow: hidden;
            height: auto;
        }
        body {
            margin: 0;
            padding: 10px;
            overflow: hidden;
            height: auto;
            background: transparent;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }
        #root {
            overflow: hidden;
            height: auto;
        }
        @keyframes pulse-ring {
            0%   { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(74,222,128,0.7); }
            70%  { transform: scale(1);    box-shadow: 0 0 0 8px rgba(74,222,128,0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(74,222,128,0); }
        }
        .pulse { border-radius: 50%; animation: pulse-ring 2s infinite; }
    </style>
</head>
<body>
    <div id="root">Loading...</div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const CrewBadge = () => {
            const qrRef = useRef(null);
            const [timeString, setTimeString] = useState('');
            const [qrReady, setQrReady] = useState(false);

            // --- HARDCODED USER ---
            const user = {
                id:         "CRW-84920",
                firstName:  "Sarah",
                lastName:   "Jenkins",
                role:       "Guest Experience Manager",
                ship:       "Carnival Celebration"
            };

            // Live clock
            useEffect(() => {
                const tick = () => {
                    const now = new Date();
                    setTimeString(now.toLocaleTimeString([], {
                        hour: '2-digit', minute: '2-digit', second: '2-digit'
                    }));
                };
                tick();
                const t = setInterval(tick, 1000);
                return () => clearInterval(t);
            }, []);

            // QR code (generate once, no re-renders)
            useEffect(() => {
                if (qrRef.current && !qrReady) {
                    qrRef.current.innerHTML = '';
                    new QRCode(qrRef.current, {
                        text: `UID:${user.id}|NAME:${user.firstName} ${user.lastName}`,
                        width: 150,
                        height: 150,
                        colorDark: '#00205B',
                        colorLight: '#ffffff',
                        correctLevel: QRCode.CorrectLevel.H
                    });
                    setQrReady(true);
                }
            }, []);

            return (
                <div className="w-full max-w-sm mx-auto">
                    <div className="bg-white rounded-2xl border border-gray-200 overflow-hidden"
                         style={{ boxShadow: '0 4px 20px rgba(0,0,0,0.10)' }}>

                        {/* â”€â”€ Security Header â”€â”€ */}
                        <div className="bg-carnivalDark px-4 py-2 flex justify-between items-center">
                            <span className="flex items-center gap-2 text-white text-xs font-semibold">
                                <span className="pulse w-2.5 h-2.5 bg-green-400 inline-block"></span>
                                Active Status
                            </span>
                            <span className="text-white text-xs font-mono opacity-90">{timeString}</span>
                        </div>

                        {/* â”€â”€ Profile â”€â”€ */}
                        <div className="flex flex-col items-center pt-5 pb-4 px-4 border-b border-gray-100 bg-gradient-to-b from-gray-50 to-white">
                            <img
                                src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Carnival_Cruise_Line_logo.svg/2560px-Carnival_Cruise_Line_logo.svg.png"
                                alt="Carnival"
                                style={{ height: '36px', objectFit: 'contain', marginBottom: '12px' }}
                            />
                            <p className="text-2xl font-bold text-gray-900 uppercase tracking-tight text-center m-0">
                                {user.firstName} {user.lastName}
                            </p>
                            <p className="text-xs font-bold text-carnivalBlue uppercase tracking-widest mt-1 mb-0.5 text-center">
                                {user.role}
                            </p>
                            <p className="text-xs text-gray-400 uppercase tracking-wide text-center m-0">
                                {user.ship}
                            </p>
                        </div>

                        {/* â”€â”€ QR Code â”€â”€ */}
                        <div className="flex flex-col items-center py-5 bg-white">
                            <div className="p-2.5 border-2 border-gray-100 rounded-xl"
                                 style={{ boxShadow: '0 1px 6px rgba(0,0,0,0.06)' }}>
                                <div ref={qrRef} id="qrcode"></div>
                            </div>
                            <p className="text-xs text-gray-400 mt-2 font-mono m-0">ID: {user.id}</p>
                        </div>

                        {/* â”€â”€ Capability Chips â”€â”€ */}
                        <div className="px-4 pb-4 grid grid-cols-3 gap-2">
                            <Chip icon="ðŸšª" label="Cabin Access" />
                            <Chip icon="ðŸªª" label="Crew ID" />
                            <Chip icon="ðŸ’³" label="Cashless Pay" />
                        </div>

                    </div>

                    {/* â”€â”€ Security Notice â”€â”€ */}
                    <p style={{ textAlign:'center', fontSize:'10px', color:'#9ca3af', marginTop:'8px' }}>
                        Security Notice: Badge refreshes live. Do not screenshot.
                    </p>
                </div>
            );
        };

        const Chip = ({ icon, label }) => (
            <div style={{
                display: 'flex',
                flexDirection: 'column',
                alignItems: 'center',
                backgroundColor: '#EFF6FF',
                borderRadius: '10px',
                padding: '8px 4px',
                textAlign: 'center'
            }}>
                <span style={{ fontSize: '18px', lineHeight: 1 }}>{icon}</span>
                <span style={{ fontSize: '9px', fontWeight: '700', color: '#0033A0', marginTop: '4px', textTransform: 'uppercase', letterSpacing: '0.05em' }}>
                    {label}
                </span>
            </div>
        );

        ReactDOM.createRoot(document.getElementById('root')).render(<CrewBadge />);
    </script>
</body>
</html>
